---
title: "R Notebook"
output: html_notebook
---

This document serves to compare the data presented in Sydney's original XLSX 
file and the one generated by Amaradasa. He cleaned it up by inserting "unk" for
missing values. Because there was no file trail for this other than his own
comment, I will compare these two.





```r
library('tidyverse')
```

```
## Loading tidyverse: ggplot2
## Loading tidyverse: tibble
## Loading tidyverse: tidyr
## Loading tidyverse: readr
## Loading tidyverse: purrr
## Loading tidyverse: dplyr
```

```
## Conflicts with tidy packages ----------------------------------------------
```

```
## filter(): dplyr, stats
## lag():    dplyr, stats
```

```r
library('readxl')
```

Sydney's data is stored in excel format, so we have to use readxl to parse it.
First, we want to know what sheets exist.


```r
excel_sheets("../Analysis4 ForManu/A1_Copy of binned-genotypes_SE.xlsx")
```

```
## [1] "original"      "edited"        "GenAlex"       "replen est"   
## [5] "GenAlexBinned"
```

We will be using the GenAlexBinned sheet. From my talks with Sydney, this sheet
contains the SSR data binned into the expected allelels. Note, this sequence of
data input and cleaning was done iteratively and what you are seeing is the 
final result.

There are always quirks with the data when it's in excel. Often, there are too
many rows, so we have to remove them with `slice()`.

Quirks specific to thse data:

 - GenAlEx format has an extra header region that should be ignored
 - The loci are formatted like so: `110-4(F)`, where the `(F)` part is not 
   informative
 - The header for the strata has extra information
 

 

```r
syd <- read_excel("../Analysis4 ForManu/A1_Copy of binned-genotypes_SE.xlsx", 
                sheet = "GenAlexBinned", skip = 1) %>%
  select(-1) %>%                # removing first column, which is empty
  gather(locus, allele, -1) %>% # gather all loci into tidy columns
  mutate(locus = trimws(locus) %>% substr(1, nchar(.) - 3)) %>% # remove (F) designator
  spread(locus, allele) %>%     # spread data out with individual loci in columns
  separate(iso_st_mcg_org_loc_yr_hst_cult_rep, 
           c("Isolate", "Severity", "MCG", "State", "Source", "Year", "Host"), 
           sep = "_") %>%
  mutate_if(is.character, trimws) %>% # Trim whitespace forom all character columns
  mutate(Severity = as.numeric(Severity)) %>%
  slice(-n()) # remove last row
syd
```

```
## # A tibble: 366 Ã— 18
##    Isolate Severity   MCG State Source  Year  Host `110-4` `114-4` `12-2`
##      <chr>    <dbl> <chr> <chr>  <chr> <chr> <chr>   <dbl>   <dbl>  <dbl>
## 1      152      3.9     4    NE         2003    GH     378     371    216
## 2      274      5.4    45    NE         2003    GH     378     359    216
## 3      443      6.3     5    NY         2003    GH     378     367    216
## 4      444      4.4     4    MN    wmn  2003  G122     378     371    216
## 5      445      4.7     4    MN    wmn  2003 Beryl     378     371    216
## 6      446      6.1     3    MI    wmn  2003 Beryl     386     359    216
## 7      447      5.5     5    MI    wmn  2003 Beryl     378     367    222
## 8      448      5.0     3    MI    wmn  2003 Beryl     386     359    216
## 9      449      5.2     3    MI    wmn  2003 Bunsi     386     367    216
## 10     450      5.3     5    MI    wmn  2003 Bunsi     378     367    216
## # ... with 356 more rows, and 8 more variables: `17-3` <dbl>,
## #   `20-3` <dbl>, `5-2` <dbl>, `55-4` <dbl>, `6-2` <dbl>, `7-2` <dbl>,
## #   `8-3` <dbl>, `9-2` <dbl>
```

